<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Project ZomboidのサーバをUbuntuとDockerで構築する方法 - 塩の惑星</title><meta name="description" content="Project Zomboidはゾンビがはびこり始めた世界でアイテムを集めたりバリゲードを作ったりするサバイバル2Dゲームです。 このゲームはマルチプレイに対応していてこれが面白いのですが、Linuxなどで専用サーバを立てるのが少々難しいです。 今回は、DockerとUbuntuの環境でサーバを立てる方法を紹介します。 今回の記事ではUbuntu&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://corkborg.github.io/how-to-create-multiplayer-server-project-zomboid/"><link rel="alternate" type="application/atom+xml" href="https://corkborg.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://corkborg.github.io/feed.json"><meta property="og:title" content="Project ZomboidのサーバをUbuntuとDockerで構築する方法"><meta property="og:image" content="https://corkborg.github.io/media/posts/7/image-6.png"><meta property="og:image:width" content="616"><meta property="og:image:height" content="353"><meta property="og:site_name" content="塩の惑星"><meta property="og:description" content="Project Zomboidはゾンビがはびこり始めた世界でアイテムを集めたりバリゲードを作ったりするサバイバル2Dゲームです。 このゲームはマルチプレイに対応していてこれが面白いのですが、Linuxなどで専用サーバを立てるのが少々難しいです。 今回は、DockerとUbuntuの環境でサーバを立てる方法を紹介します。 今回の記事ではUbuntu&hellip;"><meta property="og:url" content="https://corkborg.github.io/how-to-create-multiplayer-server-project-zomboid/"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://corkborg.github.io/media/website/icon.ico" type="image/x-icon"><link rel="stylesheet" href="https://corkborg.github.io/assets/css/prism.css?v=b46352844c4922bafa71c2012d20bbac"><link rel="stylesheet" href="https://corkborg.github.io/assets/css/style.css?v=c4d8da79469c2e95773a0df01a140360"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://corkborg.github.io/how-to-create-multiplayer-server-project-zomboid/"},"headline":"Project ZomboidのサーバをUbuntuとDockerで構築する方法","datePublished":"2023-08-10T15:06","dateModified":"2024-03-24T16:26","image":{"@type":"ImageObject","url":"https://corkborg.github.io/media/posts/7/image-6.png","height":353,"width":616},"description":"Project Zomboidはゾンビがはびこり始めた世界でアイテムを集めたりバリゲードを作ったりするサバイバル2Dゲームです。 このゲームはマルチプレイに対応していてこれが面白いのですが、Linuxなどで専用サーバを立てるのが少々難しいです。 今回は、DockerとUbuntuの環境でサーバを立てる方法を紹介します。 今回の記事ではUbuntu&hellip;","author":{"@type":"Person","name":"ミズソバ","url":"https://corkborg.github.io/authors/mizusoba/"},"publisher":{"@type":"Organization","name":"ミズソバ","logo":{"@type":"ImageObject","url":"https://corkborg.github.io/media/website/logo2.png","height":344,"width":1000}}}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-Y8CYBCM4RJ"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y8CYBCM4RJ');</script></head><body><header><div id="header-upper"><div></div><a class="main-logo" href="https://corkborg.github.io/"><img src="https://corkborg.github.io/media/website/logo2.png" alt="塩の惑星" height="80px"></a><div></div></div><div><nav class="menu-navbar"><div class="menu"><div><a href="https://corkborg.github.io/contact/" target="_self">問い合わせ</a></div></div></nav></div></header><div id="main-wrapper-with-sidebar"><main><article class="post-only"><header><h1>Project ZomboidのサーバをUbuntuとDockerで構築する方法</h1><div class="modified-time">公開日: <time datetime="2023-08-10T15:06">2023-08-10 </time><span id="post-tags"><span class="post-tag"><a href="https://corkborg.github.io/tags/linux/">Linux </a></span><span class="post-tag"><a href="https://corkborg.github.io/tags/steam/">Steam </a></span><span class="post-tag"><a href="https://corkborg.github.io/tags/geme/">ゲーム</a></span></span></div></header><figure id="featured-image"><img src="https://corkborg.github.io/media/posts/7/image-6.png" srcset="https://corkborg.github.io/media/posts/7/responsive/image-6-xs.png 300w, https://corkborg.github.io/media/posts/7/responsive/image-6-sm.png 480w, https://corkborg.github.io/media/posts/7/responsive/image-6-md.png 749w, https://corkborg.github.io/media/posts/7/responsive/image-6-xl.png 1200w" sizes="(max-width: 1200px) 100vw, 1200px" loading="eager" height="353" width="616" alt="project zomboid"></figure><div id="post-entry"><p>Project Zomboidはゾンビがはびこり始めた世界でアイテムを集めたりバリゲードを作ったりするサバイバル2Dゲームです。</p><p>このゲームはマルチプレイに対応していてこれが面白いのですが、Linuxなどで専用サーバを立てるのが少々難しいです。<br>今回は、DockerとUbuntuの環境でサーバを立てる方法を紹介します。</p><h2>環境</h2><p>今回の記事ではUbuntu 20.04にDocker CEをインストールした環境で、Dockerコンテナ上にサーバ構築を行いました。<br>Dockerを使用しているのでほかのバージョンのUbuntuやLinuxでも問題なく動くと思います。</p><p>Dockerが入っていない場合は下記を参考にインストールしておいてください。<br><a href="https://docs.docker.com/engine/install/ubuntu/" target="_blank" rel="noopener noreferrer">Docker公式: Install Docker Engine on Ubuntu</a></p><h2>サーバファイルの用意</h2><p>SteamではLinux環境向けにゲームサーバを用意するためのSteamCMDというコマンドが用意されています。</p><div>zomboidもこれに対応しているのでSteamCMDに対して専用コマンドを打っていくことでゲームサーバの準備ができるようになっています。</div><p>まず、サーバを構築するディレクトリを作ってください。<br>そのあと下記の3つのファイルをディレクトリ内に作成してください。</p><h3>update_zomboid.txt</h3><div><div>このファイルは、SteamCMD向けの指示コマンドが列挙されたシェルファイルのようなものです。</div><div>380870という番号はProject Zomboidを表すSteam固有のIDです。</div><p>このファイルでは<code>/opt/pzserver</code>というディレクトリにサーバファイルを展開するように指示してます。</p><pre><code>@ShutdownOnFailedCommand 1</code><br><code>@NoPromptForPassword 1</code><br><code>force_install_dir /opt/pzserver/</code><br><code>login anonymous</code><br><code>app_update 380870 validate</code><br><code>quit</code></pre></div><div>SteamCMDの詳細な使い方はValve公式のガイドを<br><a href="https://developer.valvesoftware.com/wiki/SteamCMD">https://developer.valvesoftware.com/wiki/SteamCMD</a></div><div><h4>Dockerfile</h4><div>サーバのイメージを作成するためのDockerファイルです。</div><p>Dockerfileはサーバの構築方法を指示するものです。下記では構築時にupdate_zomboid.txtを実行して初期化を済ませるように指示しています。</p><pre class="language-docker"><code>FROM steamcmd/steamcmd:ubuntu-20

RUN mkdir /opt/pzserver
WORKDIR /opt/pzserver
COPY update_zomboid.txt /opt/update_zomboid.txt
RUN steamcmd +runscript /opt/update_zomboid.txt
ENTRYPOINT ["/bin/bash" , "-l"]</code></pre><p>Dockerfileの書き方は下記を参照してください。<br><a href="https://docs.docker.jp/engine/reference/builder.html" target="_blank" rel="noopener noreferrer">Dockerfile リファレンス - Docker公式</a></p><h4>docker-compose.yaml</h4><p>docker-compose.yamlはサーバをどう動作させるか定義するためのファイルです。</p><p>セーブデータをディレクトリ内のsaveディレクトリに保存するように指定しています。<br>zomboidではUDPの16261と16262ポートを使用するので開放させておきます。</p><pre class="language-yaml"><code>version: '3'
services:
    zomboid:
        build: .
        container_name: zomboid
        volumes:
          - ./save:/root/Zomboid
        ports:
          - "16261:16261/udp"
          - "16262:16262/udp"
        command: /opt/pzserver/start-server.sh</code></pre><p>docker composeの書き方は下記を参考にしてください。<br><a href="https://docs.docker.jp/compose/toc.html" target="_blank" rel="noopener noreferrer">Docker Compose - Docker公式</a></p><h3>セーブディレクトリの作成</h3><p>ディレクトリ内で下記を実行してセーブデータを入れるディレクトリを作ります。</p><pre class="language-bash"><code>mkdir save</code></pre><h2> テスト起動</h2><p>一回テスト起動します。</p><pre class="language-bash"><code>docker-compose build
docker-compose up</code></pre><div><div>こんな感じのログが出力されたら成功です。</div><div><pre class="prettyprint prettyprinted"><span class="pln">zomboid    </span><span class="pun">|</span><span class="pln"> LOG  </span><span class="pun">:</span> <span class="typ">Network</span><span class="pln">     </span><span class="pun">,</span> <span class="lit">1688801808085</span><span class="pun">&gt;</span> <span class="lit">4</span><span class="pun">,</span><span class="lit">060</span><span class="pun">,</span><span class="lit">110</span><span class="pun">,</span><span class="lit">023</span><span class="pun">&gt;</span> <span class="pun">***</span><span class="pln"> SERVER STARTED </span><span class="pun">****</span><span class="pln">
zomboid    </span><span class="pun">|</span><span class="pln"> LOG  </span><span class="pun">:</span> <span class="typ">Network</span><span class="pln">     </span><span class="pun">,</span> <span class="lit">1688801808085</span><span class="pun">&gt;</span> <span class="lit">4</span><span class="pun">,</span><span class="lit">060</span><span class="pun">,</span><span class="lit">110</span><span class="pun">,</span><span class="lit">023</span><span class="pun">&gt;</span> <span class="pun">***</span> <span class="typ">Steam</span> <span class="kwd">is</span><span class="pln"> enabled</span></pre><div><div>Steam is enabledが出ていない場合サーバは起動していますが、Steam版のZomboidで遊ぶことができなかったような気がします。</div><div> </div><div>一回サーバを落とします（ctrl + c とかdocker-compose downとか）。</div><div> </div><div><h2>サーバ設定の編集</h2><div>セーブデータ内の下記ファイルを編集してサーバ設定を作ります。</div><div>手順通り作業しているのであれば下記のパスにあるはずです。</div><pre>save/Server/servertest.ini</pre><h2>ポート開放</h2><p>UDPの16261と16262ポートがインターネット側からアクセスできるようにファイアウォールやルータの設定を変更します。</p><h2>サーバ起動</h2><div>サーバを起動します。</div><div>Project Zomboidを起動してアクセスできることを確認しましょう。</div><div><pre class="language-bash"><code>docker compose up -d</code></pre></div><h2> まとめ</h2><p> steamcmdコマンド使ってproject zomboidのマルチプレイヤーサーバを立てることができました。</p></div></div></div></div></div></div><div class="modified-time">更新日: <time datetime="2024-03-24T16:26">2024-03-24</time></div><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fcorkborg.github.io%2Fhow-to-create-multiplayer-server-project-zomboid%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer" aria-label="Share with Facebook"><svg class="u-icon"><use xlink:href="https://corkborg.github.io/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/share?url=https%3A%2F%2Fcorkborg.github.io%2Fhow-to-create-multiplayer-server-project-zomboid%2F&amp;via=%E5%A1%A9%E3%81%AE%E6%83%91%E6%98%9F&amp;text=Project%20Zomboid%E3%81%AE%E3%82%B5%E3%83%BC%E3%83%90%E3%82%92Ubuntu%E3%81%A8Docker%E3%81%A7%E6%A7%8B%E7%AF%89%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer" target="_blank" aria-label="Share with Twitter"><svg class="u-icon"><use xlink:href="https://corkborg.github.io/assets/svg/svg-map.svg#twitter"/></svg></a></div><nav id="post-navigation"><div class="post-navigation-link"><a href="https://corkborg.github.io/arma3-support-apple-silicon-m1-macbook-air/" rel="prev">&larr; 前の記事: Arma3はApple Siliconにネイティブ対応している？M1 MacBook Airで試してみた</a></div><div class="post-navigation-link"><a href="https://corkborg.github.io/steam-games-support-apple-silicon/" rel="next">次の記事: Apple Silicon Macで遊べるゲームリスト. M1 Macで検証してみた &rarr;</a></div></nav></article></main><aside><section><h3>Featured posts</h3><ol class="featured-posts__list"><li><a href="https://corkborg.github.io/created-kanji-to-time/" class="invert">日本語や漢字の日付をPythonのdatetimeに変換するライブラリを作った</a></li><li><a href="https://corkborg.github.io/publii-is-good-website-generator/" class="invert">使いやすいエディターで静的サイト生成できるPubliiがおすすめな話</a></li><li><a href="https://corkborg.github.io/energy-saving-battle-gaming-pc-vs-apple-silicon-mac/" class="invert">ゲーミングPCは電気代が高い！電気代が安いApple Silicon Macのゲームでの省電力能力を検証</a></li><li><a href="https://corkborg.github.io/steam-games-support-apple-silicon/" class="invert">Apple Silicon Macで遊べるゲームリスト. M1 Macで検証してみた</a></li><li><a href="https://corkborg.github.io/arma3-support-apple-silicon-m1-macbook-air/" class="invert">Arma3はApple Siliconにネイティブ対応している？M1 MacBook Airで試してみた</a></li></ol></section></aside></div><footer><nav class="menu-navbar"><div class="menu"><div><a href="https://corkborg.github.io/contact/" target="_self">問い合わせ</a></div></div></nav><div id="footer-lower"><div></div><a class="main-logo" href="https://corkborg.github.io/"><img src="https://corkborg.github.io/media/website/logo2.png" alt="塩の惑星" height="80px"></a><div></div></div></footer><script defer="defer" src="https://corkborg.github.io/assets/js/prism.js?v=2730b884bcd782a7b6ffd13dcb5504c0"></script><script async src="https://corkborg.github.io/assets/js/scripts.js?v=3733efd39cd6c799b95c8fcb96993840"></script></body></html>