<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Project ZomboidのサーバをUbuntuとDockerで立てる方法 - 塩の惑星</title><meta name="description" content="Project Zomboidはゾンビがはびこり始めた世界でどう生き残るかというサバイバル2Dゲームです。このゲームはマルチプレイに対応しているのですがサーバを立てるのが少々面倒くさいです。今回はDockerとUbuntuの環境でサーバを立てる方法を紹介します。 Project Zomboidのサーバを運用していたのは１年位前なのでうろ覚えなところもあります。 今回の記事ではUbuntu&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://corkborg.github.io/how-to-create-multiplayer-server-project-zomboid/"><link rel="alternate" type="application/atom+xml" href="https://corkborg.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://corkborg.github.io/feed.json"><meta property="og:title" content="Project ZomboidのサーバをUbuntuとDockerで立てる方法"><meta property="og:image" content="https://corkborg.github.io/media/posts/7/image-6.png"><meta property="og:image:width" content="616"><meta property="og:image:height" content="353"><meta property="og:site_name" content="塩の惑星"><meta property="og:description" content="Project Zomboidはゾンビがはびこり始めた世界でどう生き残るかというサバイバル2Dゲームです。このゲームはマルチプレイに対応しているのですがサーバを立てるのが少々面倒くさいです。今回はDockerとUbuntuの環境でサーバを立てる方法を紹介します。 Project Zomboidのサーバを運用していたのは１年位前なのでうろ覚えなところもあります。 今回の記事ではUbuntu&hellip;"><meta property="og:url" content="https://corkborg.github.io/how-to-create-multiplayer-server-project-zomboid/"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://corkborg.github.io/media/website/icon.ico" type="image/x-icon"><link rel="stylesheet" href="https://corkborg.github.io/assets/css/style.css?v=7bec7e772fc13082f845661beb788543"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://corkborg.github.io/how-to-create-multiplayer-server-project-zomboid/index.html"},"headline":"Project ZomboidのサーバをUbuntuとDockerで立てる方法","datePublished":"2023-08-10T15:06","dateModified":"2023-08-12T01:51","image":{"@type":"ImageObject","url":"https://corkborg.github.io/media/posts/7/image-6.png","height":353,"width":616},"description":"Project Zomboidはゾンビがはびこり始めた世界でどう生き残るかというサバイバル2Dゲームです。このゲームはマルチプレイに対応しているのですがサーバを立てるのが少々面倒くさいです。今回はDockerとUbuntuの環境でサーバを立てる方法を紹介します。 Project Zomboidのサーバを運用していたのは１年位前なのでうろ覚えなところもあります。 今回の記事ではUbuntu&hellip;","author":{"@type":"Person","name":"ミズソバ","url":"https://corkborg.github.io/authors/mizusoba/"},"publisher":{"@type":"Organization","name":"ミズソバ","logo":{"@type":"ImageObject","url":"https://corkborg.github.io/media/website/logo2.png","height":344,"width":1000}}}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-Y8CYBCM4RJ"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Y8CYBCM4RJ');</script></head><body><header><div id="header-upper"><div></div><a class="main-logo" href="https://corkborg.github.io/index.html"><img src="https://corkborg.github.io/media/website/logo2.png" alt="塩の惑星" height="80px"></a><div></div></div><div><nav><div class="menu"><div><a href="https://corkborg.github.io/support/index.html" target="_self">問い合わせ</a></div></div></nav></div></header><div id="main-wrapper-for-post"><div id="main-wrapper-for-post-left"></div><main><article class="post-only"><header><h1>Project ZomboidのサーバをUbuntuとDockerで立てる方法</h1><time datetime="2023-08-10T15:06">2023-08-10 </time><span id="post-tags"><span class="post-tag"><a href="https://corkborg.github.io/tags/linux/index.html">Linux </a></span><span class="post-tag"><a href="https://corkborg.github.io/tags/steam/index.html">Steam </a></span><span class="post-tag"><a href="https://corkborg.github.io/tags/gemu/index.html">ゲーム</a></span></span></header><figure id="featured-image"><img src="https://corkborg.github.io/media/posts/7/image-6.png" srcset="https://corkborg.github.io/media/posts/7/responsive/image-6-xs.png 300w, https://corkborg.github.io/media/posts/7/responsive/image-6-sm.png 480w, https://corkborg.github.io/media/posts/7/responsive/image-6-md.png 749w, https://corkborg.github.io/media/posts/7/responsive/image-6-xl.png 1200w" sizes="(max-width: 1200px) 100vw, 1200px" loading="eager" height="353" width="616" alt=""></figure><div id="post-entry"><p>Project Zomboidはゾンビがはびこり始めた世界でどう生き残るかというサバイバル2Dゲームです。このゲームはマルチプレイに対応しているのですがサーバを立てるのが少々面倒くさいです。今回はDockerとUbuntuの環境でサーバを立てる方法を紹介します。</p><p>Project Zomboidのサーバを運用していたのは１年位前なのでうろ覚えなところもあります。</p><h2>環境</h2><p>今回の記事ではUbuntu 20.04にDocker CEをインストールした環境で、Dockerコンテナ上にサーバ構築を行っていきます。</p><h2>サーバファイルの用意</h2><div>SteamではLinux環境向けにゲームサーバを用意するためのコマンドSteamCMDというものが用意されています。</div><div>zomboidもこれに対応しているのでSteamCMDに対して専用コマンドを打っていくとゲームサーバの環境の準備ができるようになっています。</div><div> </div><div>適当なディレクトリ、３つのファイルを用意します</div><h3>update_zomboid.txt</h3><div><div>このファイルはSteamCMD向けの指示コマンドが列挙されたシェルファイルのようなものです。</div><div>380870というのはProject Zomboidを表すSteam固有のidです。</div><div>このファイルでは/opt/pzserverというディレクトリにサーバファイルを展開するように指示してます。</div><pre>@ShutdownOnFailedCommand 1<br>@NoPromptForPassword 1<br>force_install_dir /opt/pzserver/<br>login anonymous<br>app_update 380870 validate<br>quit</pre></div><div>SteamCMDの詳細な使い方はValve公式のガイドを<br><a href="https://developer.valvesoftware.com/wiki/SteamCMD">https://developer.valvesoftware.com/wiki/SteamCMD</a></div><div><h4>Dockerfile</h4><div>サーバのイメージを作成するためのファイルです。</div><div>イメージ内でupdate_zomboid.txtを実行しておいて初期化を済ませておきます。</div><pre class="prettyprint prettyprinted"><span class="pln">FROM steamcmd</span><span class="pun">/</span><span class="pln">steamcmd</span><span class="pun">:</span><span class="pln">ubuntu</span><span class="pun">-</span><span class="lit">20</span><span class="pln">

RUN mkdir </span><span class="pun">/</span><span class="pln">opt</span><span class="pun">/</span><span class="pln">pzserver
WORKDIR </span><span class="pun">/</span><span class="pln">opt</span><span class="pun">/</span><span class="pln">pzserver
COPY update_zomboid</span><span class="pun">.</span><span class="pln">txt </span><span class="pun">/</span><span class="pln">opt</span><span class="pun">/</span><span class="pln">update_zomboid</span><span class="pun">.</span><span class="pln">txt
RUN steamcmd </span><span class="pun">+</span><span class="pln">runscript </span><span class="pun">/</span><span class="pln">opt</span><span class="pun">/</span><span class="pln">update_zomboid</span><span class="pun">.</span><span class="pln">txt
ENTRYPOINT </span><span class="pun">[</span><span class="str">"/bin/bash"</span> <span class="pun">,</span> <span class="str">"-l"</span><span class="pun">]<br></span></pre><h4>docker-compose.yaml</h4><p>実際のサーバをどう動作させるか定義するためのファイルです。<br>セーブデータをUbuntuのsaveディレクトリに保存するように指定しています（saveディレクトリを作成しておいてください）。<br>zomboidではUDPの16261と16262ポートを使用するので開放させておきます。</p><pre class="prettyprint lang-yaml prettyprinted"><span class="pln">version</span><span class="pun">:</span> <span class="str">'3'</span><span class="pln">
services</span><span class="pun">:</span><span class="pln">
    zomboid</span><span class="pun">:</span><span class="pln">
        build</span><span class="pun">:</span> <span class="pun">.</span><span class="pln">
        container_name</span><span class="pun">:</span><span class="pln"> zomboid
        volumes</span><span class="pun">:</span>
          <span class="pun">-</span> <span class="pun">./</span><span class="pln">save</span><span class="pun">:</span><span class="str">/root/</span><span class="typ">Zomboid</span><span class="pln">
        ports</span><span class="pun">:</span>
          <span class="pun">-</span> <span class="str">"16261:16261/udp"</span>
          <span class="pun">-</span> <span class="str">"16262:16262/udp"</span><span class="pln">
        command</span><span class="pun">:</span> <span class="str">/opt/</span><span class="pln">pzserver</span><span class="pun">/</span><span class="pln">start</span><span class="pun">-</span><span class="pln">server</span><span class="pun">.</span><span class="pln">sh</span></pre><h2> テスト起動</h2><p>一回テスト起動します。</p><pre class="prettyprint prettyprinted"><span class="pln">docker</span><span class="pun">-</span><span class="pln">compose build
docker</span><span class="pun">-</span><span class="pln">compose up</span></pre><div><div>こんな感じのログが出力されたら成功です。</div><div><pre class="prettyprint prettyprinted"><span class="pln">zomboid    </span><span class="pun">|</span><span class="pln"> LOG  </span><span class="pun">:</span> <span class="typ">Network</span><span class="pln">     </span><span class="pun">,</span> <span class="lit">1688801808085</span><span class="pun">&gt;</span> <span class="lit">4</span><span class="pun">,</span><span class="lit">060</span><span class="pun">,</span><span class="lit">110</span><span class="pun">,</span><span class="lit">023</span><span class="pun">&gt;</span> <span class="pun">***</span><span class="pln"> SERVER STARTED </span><span class="pun">****</span><span class="pln">
zomboid    </span><span class="pun">|</span><span class="pln"> LOG  </span><span class="pun">:</span> <span class="typ">Network</span><span class="pln">     </span><span class="pun">,</span> <span class="lit">1688801808085</span><span class="pun">&gt;</span> <span class="lit">4</span><span class="pun">,</span><span class="lit">060</span><span class="pun">,</span><span class="lit">110</span><span class="pun">,</span><span class="lit">023</span><span class="pun">&gt;</span> <span class="pun">***</span> <span class="typ">Steam</span> <span class="kwd">is</span><span class="pln"> enabled</span></pre><div><div>Steam is enabledが出ていない場合サーバは起動していますが、Steam版のZomboidで遊ぶことができなかったような気がします。</div><div> </div><div>一回サーバを落とします（ctrl + c とかdocker-compose downとか）。</div><div> </div><div><h2>サーバ設定の編集</h2><div>セーブデータ内の下記ファイルを編集してサーバ設定を作ります。</div><div>手順通り作業しているのであれば下記のパスにあるはずです。</div><div> </div><pre>save/Server/servertest.ini</pre><div> </div><div>（なんか色々な設定が必要だった気がするのですが覚えていません。）</div><div> </div><h2>ポート開放</h2><p>UDPの16261と16262ポートがインターネット側からアクセスできるようにファイアウォールやルータの設定を変更します。</p><h2>サーバ起動</h2><div>サーバを起動します。</div><div>Project Zomboidを起動してアクセスできることを確認しましょう。</div><div><pre class="prettyprint prettyprinted"><span class="pln">docker　</span><span class="pln">compose up </span><span class="pun">-</span><span class="pln">d</span></pre></div><h2> まとめ</h2><p> steamcmdコマンドつかってproject zomboidのマルチプレイヤーサーバを立てることができました。</p></div></div></div></div></div></div>Updated on: <time datetime="2023-08-12T01:51">2023-08-12</time><nav id="post-navigation"><div class="post-navigation-link"><a href="https://corkborg.github.io/arma3-support-apple-silicon-m1-macbook-air/index.html" rel="prev">&larr; Previous: Arma3はApple Siliconにネイティブ対応している？M1 MacBook Airで試してみた</a></div></nav></article></main><aside><section><h3>Selected posts</h3><ul><li><a href="https://corkborg.github.io/factorio-support-applesilicon/index.html">FactorioがApple siliconに対応したようなのでM1 Macで遊んでみた</a></li><li><a href="https://corkborg.github.io/steam-version-factorio-support-applesilicon/index.html">Steam版のFactorioがApple siliconに対応しているか検証してみた</a></li><li><a href="https://corkborg.github.io/dirt-rally-20dechu-xin-zhe-noqing-nizhi-ritakatutakotojie-shuo/index.html">Dirt Rally 2.0で初心者の頃に知りたかったこと解説</a></li></ul></section></aside></div><footer><nav><div class="menu"><div><a href="https://corkborg.github.io/support/index.html" target="_self">問い合わせ</a></div></div></nav><div id="footer-lower"><div></div><a class="main-logo" href="https://corkborg.github.io/index.html"><img src="https://corkborg.github.io/media/website/logo2.png" alt="塩の惑星" height="80px"></a><div></div></div></footer><script async src="https://corkborg.github.io/assets/js/scripts.js?v=3733efd39cd6c799b95c8fcb96993840"></script></body></html>